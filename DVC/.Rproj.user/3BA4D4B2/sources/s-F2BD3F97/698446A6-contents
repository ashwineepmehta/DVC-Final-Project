# ICE # 6 ####

## Importing libraries ####
library(socviz)
library(tidyverse)
library(ggrepel)

## Initiate labels ####
p_title <- "Presidential Elections: Popular & Electoral College Margins"
p_subtitle <- "1824-2016"
p_caption <- "Data for 2016 are provisional."
x_label <- "Winner's share of Popular Vote"
y_label <- "Winner's share of Electoral College Votes"


## Subset with labels #####
names(elections_historic)
head(elections_historic$year)
?subset()

p <- ggplot(elections_historic, aes(x = popular_pct, y = ec_pct,
                                    label =  winner_label))

p + geom_hline(yintercept = 0.5, size = 1.4, color = "gray80") +
  geom_vline(xintercept = 0.5, size = 1.4, color = "gray80") +
  geom_point() +
  geom_text_repel(data=subset(elections_historic, year >= 1992)) +
  scale_x_continuous(labels = scales::percent) +
  scale_y_continuous(labels = scales::percent) +
  labs(x = x_label, y = y_label, title = p_title, subtitle = p_subtitle,
       caption = p_caption)

## Subset with colors ####
names(elections_historic)
head(elections_historic$win_party)
elec_data <- elections_historic
elec_data$ind <- elec_data$win_party %in% c("Dem.")

p <- ggplot(elec_data, aes(x = popular_pct, y = ec_pct,
                                    label =  win_party))

p + geom_hline(yintercept = 0.5, size = 1.4, color = "gray80") +
  geom_vline(xintercept = 0.5, size = 1.4, color = "gray80") +
  geom_point(data = elec_data, mapping=aes(color=ind)) +
  geom_text_repel(data=subset(elec_data,ind)) +
  scale_x_continuous(labels = scales::percent) +
  scale_y_continuous(labels = scales::percent) +
  labs(x = x_label, y = y_label, title = p_title, subtitle = p_subtitle,
       caption = p_caption)+
  guides(color =FALSE)

